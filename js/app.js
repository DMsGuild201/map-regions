!function(e){function t(n){if(o[n])return o[n].exports;var r=o[n]={i:n,l:!1,exports:{}};return e[n].call(r.exports,r,r.exports,t),r.l=!0,r.exports}var o={};t.m=e,t.c=o,t.d=function(e,o,n){t.o(e,o)||Object.defineProperty(e,o,{enumerable:!0,get:n})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,o){if(1&o&&(e=t(e)),8&o)return e;if(4&o&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(t.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&o&&"string"!=typeof e)for(var r in e)t.d(n,r,function(t){return e[t]}.bind(null,r));return n},t.n=function(e){var o=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(o,"a",o),o},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="./",t(t.s=0)}([function(){var e,t,o=!0,n=[],r=[],i=!1,a="",l=0,c=null;$(window).load((function(){s.initCanvas(),$("#urlField").change((function(){fabric.Image.fromURL($("#urlField").val(),(function(e){t.setWidth(e.width),t.setHeight(e.height),t.setBackgroundImage(e,t.renderAll.bind(t),{})}))})),$("html").keydown((function(e){if(46===e.keyCode||8===e.keyCode)for(;0<t.getActiveObjects().length;)t.remove(t.getActiveObject()),t.remove(t.getActiveObjects()[0])})),$("#new").click((function(){s.polygon.drawPolygon()})),$("#set-prefix").click((function(){a=window.prompt("Input an area label prefix (e.g. 'A'):")})),$("#set-increment").click((function(){l=parseInt(window.prompt("Input a value to incrementate by (e.g. '1' or '-1'):")),c=parseInt(window.prompt("Input an integer start value (e.g. '5'):"))})),$("#export").click((function(){for(var e={mapRegions:[]},o=t.toJSON().objects,n=0;n<o.length;n++)e.mapRegions.push({area:"",points:[]}),o[n].objects[0].points.forEach((function(t){e.mapRegions[n].points.push([t.x,t.y])})),e.mapRegions[n].area=o[n].objects[1].text;window.prompt("Copy this to your clipboard",JSON.stringify(e))}))}));var s=new function(){this.initCanvas=function(){(t=window._canvas=new fabric.Canvas("c")).selection=!1,t.on("mouse:down",(function(e){e.target&&e.target.id==n[0].id&&s.polygon.generatePolygon(n),o&&s.polygon.addPoint(e)})),t.on("mouse:move",(function(o){if(e&&"line"==e.class){var r=t.getPointer(o.e);e.set({x2:r.x,y2:r.y});var a=i.get("points");a[n.length]={x:r.x,y:r.y},i.set({points:a}),t.renderAll()}t.renderAll()}))}};s.polygon={drawPolygon:function(){o=!0,n=[],r=[]},addPoint:function(o){var a=Math.floor(999901*Math.random())+99,l=(new Date).getTime()+a,c=new fabric.Circle({radius:5,fill:"#ffffff",stroke:"#333333",strokeWidth:.5,left:o.e.layerX/t.getZoom(),top:o.e.layerY/t.getZoom(),selectable:!1,hasBorders:!1,hasControls:!1,originX:"center",originY:"center",id:l,objectCaching:!1});0==n.length&&c.set({fill:"red"});var s=[o.e.layerX/t.getZoom(),o.e.layerY/t.getZoom(),o.e.layerX/t.getZoom(),o.e.layerY/t.getZoom()],f=new fabric.Line(s,{strokeWidth:2,fill:"#999999",stroke:"#999999",class:"line",originX:"center",originY:"center",selectable:!1,hasBorders:!1,hasControls:!1,evented:!1,objectCaching:!1});if(i){var d=t.getPointer(o.e);(s=i.get("points")).push({x:d.x,y:d.y});var u=new fabric.Polygon(s,{stroke:"#333333",strokeWidth:1,fill:"#cccccc",opacity:.3,selectable:!1,hasBorders:!1,hasControls:!1,evented:!1,objectCaching:!1});t.remove(i),t.add(u),i=u,t.renderAll()}else{var g=[{x:o.e.layerX/t.getZoom(),y:o.e.layerY/t.getZoom()}];u=new fabric.Polygon(g,{stroke:"#337ab7",strokeWidth:2,fill:"#337ab760",opacity:.5,selectable:!1,hasBorders:!1,hasControls:!1,evented:!1,objectCaching:!1});i=u,t.add(u)}e=f,n.push(c),r.push(f),t.add(f),t.add(c),t.selection=!1},generatePolygon:function(n){var s=[];$.each(n,(function(e,o){s.push({x:o.left,y:o.top}),t.remove(o)})),$.each(r,(function(e,o){t.remove(o)})),t.remove(i).remove(e);var f,d=new fabric.Polygon(s,{stroke:"#337ab7",strokeWidth:2,fill:"#337ab760",opacity:1,hasBorders:!0,hasControls:!0});0===l?f=a+window.prompt("What area is this?"):(f=a+c,c+=parseInt(l));var u=new fabric.Text(f,{left:d.left+d.width/2,top:d.top+d.height/2}),g=new fabric.Group([d,u],{});t.add(g),e=null,i=null,o=!1,t.selection=!0}}}]);
//# sourceMappingURL=app.js.map